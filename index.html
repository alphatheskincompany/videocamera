<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Apresentador Pro — Lousa</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              50: '#eef2ff', 100: '#e0e7ff', 200: '#c7d2fe', 300: '#a5b4fc', 400: '#818cf8', 500: '#6366f1', 600: '#4f46e5', 700: '#4338ca', 800: '#3730a3', 900: '#312e81'
            }
          },
          boxShadow: {
            glow: '0 10px 30px rgba(79,70,229,.45)'
          }
        }
      }
    }
  </script>
  <style>
    .drag-handle { cursor: move; }
    video:is([data-ready="false"]) { display: none; }
    .smooth { transition: transform .15s ease, box-shadow .15s ease, border-radius .2s ease; }
    .supports-backdrop:backdrop { backdrop-filter: blur(8px); }
  </style>
</head>
<body class="bg-gray-950 text-white min-h-screen">
  <header class="fixed top-0 inset-x-0 z-40">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-3">
      <div class="flex items-center justify-between rounded-2xl bg-white/5 ring-1 ring-white/10 backdrop-blur px-4 py-2">
        <div class="flex items-center gap-2">
          <div class="h-2 w-2 rounded-full bg-emerald-400 animate-pulse" id="statusDot"></div>
          <span class="font-semibold tracking-tight">Apresentador Pro — Lousa</span>
          <span class="text-xs text-white/60 hidden sm:inline" id="statusText">Pronto</span>
        </div>
        <div class="flex items-center gap-2">
          <button id="btnStart" class="rounded-lg bg-brand-600 hover:bg-brand-700 active:bg-brand-800 px-4 py-2 text-sm font-semibold shadow-glow focus:outline-none focus:ring-2 focus:ring-brand-400">
            Iniciar apresentação
          </button>
          <button id="btnStop" class="rounded-lg bg-white/10 hover:bg-white/20 px-4 py-2 text-sm font-semibold hidden">Encerrar</button>
        </div>
      </div>
    </div>
  </header>

  <main class="relative h-[100dvh] w-full overflow-hidden" id="stage">
    <video id="screenVideo" autoplay playsinline data-ready="false"
           class="absolute inset-0 h-full w-full object-contain bg-gray-900"></video>

    <div id="webcamWrap" class="absolute left-4 bottom-4 z-30 hidden">
      <div class="drag-handle absolute -top-3 -left-3 bg-brand-600 text-white text-[10px] px-2 py-1 rounded-md shadow ring-1 ring-white/10 select-none">
        arraste
      </div>
      <video id="webcamVideo" autoplay muted playsinline data-ready="false"
             class="smooth h-[220px] w-[220px] object-cover rounded-full ring-4 ring-brand-600 shadow-xl"></video>
      <div class="mt-2 flex items-center gap-2">
        <button id="btnShape" class="text-xs bg-white/10 hover:bg-white/20 px-2 py-1 rounded">Forma</button>
        <button id="btnFlip" class="text-xs bg-white/10 hover:bg-white/20 px-2 py-1 rounded">Espelhar</button>
        <button id="btnCorner" class="text-xs bg-white/10 hover:bg-white/20 px-2 py-1 rounded">Snap canto</button>
        <input id="sizeRange" type="range" min="140" max="360" value="220" class="h-1 w-32 accent-brand-600"/>
      </div>
    </div>

    <section id="panel" class="pointer-events-auto fixed right-4 top-20 z-40 w-[320px] max-w-[92vw] rounded-2xl bg-white/5 ring-1 ring-white/10 backdrop-blur p-4 space-y-3">
      <h2 class="text-sm font-semibold tracking-tight">Controles</h2>
      <div class="grid grid-cols-2 gap-2">
        <button id="btnScreen" class="col-span-2 bg-white/10 hover:bg-white/20 rounded-lg px-3 py-2 text-sm">Compartilhar tela</button>
        <button id="btnWebcam" class="bg-white/10 hover:bg-white/20 rounded-lg px-3 py-2 text-sm">Câmera</button>
        <button id="btnMic" class="bg-white/10 hover:bg-white/20 rounded-lg px-3 py-2 text-sm">Mic (tela)</button>
        <button id="btnReset" class="col-span-2 bg-white/10 hover:bg-white/20 rounded-lg px-3 py-2 text-sm">Reset UI</button>
      </div>
      <p id="tip" class="text-xs text-white/60">Dica: arraste a bolha da câmera; use “Forma”, “Espelhar” e “Snap canto”.</p>
      <div id="warn" class="hidden text-xs rounded-lg bg-amber-500/20 text-amber-200 p-2">
        Captura de tela pode estar bloqueada no preview do navegador.
      </div>
    </section>

    <div id="toast" class="fixed left-1/2 -translate-x-1/2 top-5 z-50 hidden rounded-lg bg-emerald-600 text-white px-4 py-2 shadow-lg"></div>
  </main>

  <script>
    const screenVideo = document.getElementById('screenVideo');
    const webcamVideo = document.getElementById('webcamVideo');
    let flipped = false;

    // Ajuste: câmera não espelhada por padrão
    webcamVideo.style.transform = 'none';

    document.getElementById('btnFlip').addEventListener('click', () => {
      flipped = !flipped;
      webcamVideo.style.transform = flipped ? 'scaleX(-1)' : 'none';
    });
  </script>
</body>
</html>
